<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ant Colony with Eggs</title>
<style>
  body { margin:0; overflow:hidden; background:#a3d9a5; }
  canvas { display:block; margin:0 auto; background:#c2b280; }
</style>
</head>
<body>
<canvas id="gameCanvas" width="800" height="600"></canvas>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

let score = 0;
let colonyFood = 50;
let ants = [];
let foods = [];
let spiders = [];
let eggs = [];

// Nest
const nest = {x:canvas.width/2, y:canvas.height/2, size:30};

// Player
const player = {x:nest.x, y:nest.y, size:10, speed:2, carrying:false};

// Controls
const keys = {};
document.addEventListener('keydown', e=>keys[e.key]=true);
document.addEventListener('keyup', e=>keys[e.key]=false);

// Classes
class Ant{
  constructor(x,y,type='worker'){
    this.x=x; this.y=y; this.type=type;
    this.size=type==='queen'?15:10;
    this.speed=type==='queen'?0:type==='soldier'?2:1.5;
    this.target=null;
  }
  move(){
    if(this.type==='queen') return;

    if(this.type==='worker'){
      if(!this.target || this.target.collected){
        this.target = foods[Math.floor(Math.random()*foods.length)] || null;
      }
      if(this.target){
        this.goTo(this.target.x,this.target.y);
        if(this.getDistance(this.target)<5){
          this.target.collected=true;
          colonyFood+=5; score++;
          this.target=null;
        }
      }
    }

    if(this.type==='soldier'){
      if(spiders.length>0){
        let closest=spiders[0]; let minDist=this.getDistance(closest);
        for(let s of spiders){ let d=this.getDistance(s); if(d<minDist){minDist=d; closest=s;} }
        this.goTo(closest.x,closest.y);
        if(minDist<this.size+closest.size) spiders.splice(spiders.indexOf(closest),1);
      }
    }

    let danger=this.getClosestSpider();
    if(danger && this.getDistance(danger)<80){
      let dx=this.x-danger.x, dy=this.y-danger.y, dist=Math.sqrt(dx*dx+dy*dy);
      this.x+=(dx/dist)*this.speed*1.5;
      this.y+=(dy/dist)*this.speed*1.5;
    }
  }
  goTo(tx,ty){
    let dx=tx-this.x, dy=ty-this.y, dist=Math.sqrt(dx*dx+dy*dy);
    if(dist>0){ this.x+=(dx/dist)*this.speed; this.y+=(dy/dist)*this.speed; }
  }
  getDistance(obj){ return Math.sqrt((obj.x-this.x)**2+(obj.y-this.y)**2); }
  getClosestSpider(){ if(spiders.length===0) return null; let closest=spiders[0]; let minDist=this.getDistance(closest); for(let s of spiders){ let d=this.getDistance(s); if(d<minDist){minDist=d; closest=s;} } return closest; }
  draw(){ ctx.fillStyle=this.type==='worker'?'black':this.type==='soldier'?'blue':'purple'; ctx.beginPath(); ctx.arc(this.x,this.y,this.size,0,Math.PI*2); ctx.fill(); }
}

class Food{ constructor(x,y){ this.x=x; this.y=y; this.size=6; this.collected=false; } draw(){ ctx.fillStyle='red'; ctx.beginPath(); ctx.arc(this.x,this.y,this.size,0,Math.PI*2); ctx.fill(); } }

class Spider{ constructor(x,y){ this.x=x; this.y=y; this.size=12; this.speed=1.2; } move(){ if(ants.length===0) return; let target=ants[Math.floor(Math.random()*ants.length)]; let dx=target.x-this.x, dy=target.y-this.y, dist=Math.sqrt(dx*dx+dy*dy); this.x+=(dx/dist)*this.speed; this.y+=(dy/dist)*this.speed; if(dist<this.size+target.size) ants.splice(ants.indexOf(target),1); } draw(){ ctx.fillStyle='darkred'; ctx.beginPath(); ctx.arc(this.x,this.y,this.size,0,Math.PI*2); ctx.fill(); } }

class Egg{
  constructor(){
    this.x = nest.x + (Math.random()*20-10);
    this.y = nest.y + (Math.random()*20-10);
    this.size = 5;
    this.timer = 0; // counts frames
    this.hatchTime = 600; // 10 seconds at 60fps
  }
  update(){
    this.timer++;
    if(this.timer >= this.hatchTime){
      ants.push(new Ant(nest.x+Math.random()*20-10,nest.y+Math.random()*20-10,'worker'));
      eggs.splice(eggs.indexOf(this),1);
    }
  }
  draw(){
    ctx.fillStyle='orange';
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
    ctx.fill();
  }
}

// Spawning functions
function spawnAnt(type='worker'){ ants.push(new Ant(nest.x+Math.random()*20-10,nest.y+Math.random()*20-10,type)); }
function spawnFood(){ foods.push(new Food(Math.random()*canvas.width,Math.random()*canvas.height)); }
function spawnSpider(){ spiders.push(new Spider(Math.random()*canvas.width,Math.random()*canvas.height)); }

// Initial setup
spawnAnt('queen');
for(let i=0;i<5;i++) spawnAnt();
for(let i=0;i<15;i++) spawnFood();
for(let i=0;i<3;i++) spawnSpider();

// Game loop
function gameLoop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Draw nest
  ctx.fillStyle='brown';
  ctx.beginPath();
  ctx.arc(nest.x,nest.y,nest.size,0,Math.PI*2);
  ctx.fill();

  // Update/draw eggs
  eggs.forEach(e=>{ e.update(); e.draw(); });

  // Update/draw ants
  ants.forEach(a=>{ a.move(); a.draw(); });
  // Update/draw spiders
  spiders.forEach(s=>{ s.move(); s.draw(); });
  // Draw food
  foods.forEach(f=>{ if(!f.collected) f.draw(); });

  // Queen lays eggs if colony has enough food
  if(ants.find(a=>a.type==='queen') && colonyFood>=15){
    if(Math.random()<0.01){ // small chance per frame
      eggs.push(new Egg());
      colonyFood-=15;
    }
  }

  // Player movement
  if(keys['ArrowUp']||keys['w']) player.y-=player.speed;
  if(keys['ArrowDown']||keys['s']) player.y+=player.speed;
  if(keys['ArrowLeft']||keys['a']) player.x-=player.speed;
  if(keys['ArrowRight']||keys['d']) player.x+=player.speed;

  // Player collects food
  foods.forEach(f=>{
    if(!f.collected && Math.sqrt((f.x-player.x)**2+(f.y-player.y)**2)<player.size+f.size){
      f.collected=true;
      player.carrying=true;
    }
  });
  // Player deposits food at nest
  if(player.carrying && Math.sqrt((player.x-nest.x)**2+(player.y-nest.y)**2)<nest.size){
    colonyFood+=10;
    score+=10;
    player.carrying=false;
  }

  // Draw player
  ctx.fillStyle=player.carrying?'green':'yellow';
  ctx.beginPath(); ctx.arc(player.x,player.y,player.size,0,Math.PI*2); ctx.fill();

  // Display stats
  ctx.fillStyle='black'; ctx.font='20px Arial';
  ctx.fillText(`Food Collected: ${score}`,10,30);
  ctx.fillText(`Colony Food: ${colonyFood}`,10,55);
  ctx.fillText(`Ants Alive: ${ants.length}`,10,80);
  ctx.fillText(`Eggs: ${eggs.length}`,10,105);

  requestAnimationFrame(gameLoop);
}
gameLoop();

// Click to spawn food
canvas.addEventListener('click',e=>{ foods.push(new Food(e.offsetX,e.offsetY)); });
</script>
</body>
</html>
