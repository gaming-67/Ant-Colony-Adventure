<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ant Colony Adventure</title>
<style>
body {margin:0; overflow:hidden; font-family:Arial; background:#222;}
canvas {display:block; margin:0 auto; background:#7c4a2f;}
#ui {position:absolute; top:10px; left:10px; color:white; z-index:10;}
#currentAnt, #colonyStats, #enemyStats, #controls {margin-bottom:5px;}
#updatesBtn {position:absolute; top:10px; right:10px; padding:5px 10px; background:#444; color:white; cursor:pointer; border-radius:5px;}
#updatesPanel {display:none; position:absolute; top:50px; right:10px; background:#333; color:white; padding:10px; border-radius:5px; max-width:300px;}
#overlay {position:absolute;top:0;left:0;width:100%;height:100%;color:white;text-align:center;display:flex;justify-content:center;align-items:center;font-size:30px;}
</style>
</head>
<body>
<canvas id="game"></canvas>
<div id="ui">
  <div id="currentAnt"></div>
  <div id="colonyStats"></div>
  <div id="enemyStats"></div>
  <div id="controls">Controls: Arrow/WASD = Move | Space = Attack | 1-6 = Switch Ant</div>
</div>
<div id="updatesBtn">Updates</div>
<div id="updatesPanel">
<h3>Updates</h3>
<ul>
<li>Ant mutations</li>
<li>Multiple enemy types</li>
<li>Combat with damage numbers</li>
<li>Egg hatching & colony management</li>
<li>Responsive scaling</li>
</ul>
</div>
<div id="overlay"></div>
<script>
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');
const currentAntDiv=document.getElementById('currentAnt');
const statsDiv=document.getElementById('colonyStats');
const enemyDiv=document.getElementById('enemyStats');
const updatesBtn=document.getElementById('updatesBtn');
const updatesPanel=document.getElementById('updatesPanel');
const overlay=document.getElementById('overlay');

let baseWidth=800, baseHeight=600, scale=1;
function resize(){ scale=Math.min(window.innerWidth/baseWidth, window.innerHeight/baseHeight); canvas.width=baseWidth*scale; canvas.height=baseHeight*scale;}
window.addEventListener('resize',resize);
resize();

let gameState='menu';
let keys={};
document.addEventListener('keydown',e=>keys[e.key]=true);
document.addEventListener('keyup',e=>keys[e.key]=false);
updatesBtn.onclick=()=>{ updatesPanel.style.display=updatesPanel.style.display==='none'?'block':'none'; };

let ants=[], enemies=[], foods=[], eggs=[], damages=[];
let player; 
let playerControllableAnts=[];
let playerAntIndex=0;
let colonyFood=0, score=0, gameTime=0;

// --- Damage Text ---
class DamageText{ constructor(x,y,amount){ this.x=x; this.y=y; this.amount=amount; this.timer=0; } update(){ this.y-=0.3; this.timer++; } draw(){ ctx.fillStyle='red'; ctx.font='16px Arial'; ctx.fillText(this.amount,this.x*scale,this.y*scale); }}

// --- Food ---
class Food{ constructor(x,y){ this.x=x; this.y=y; this.size=5; this.collected=false; } draw(){ let bounce=Math.sin(Date.now()/100 + this.x)*2; ctx.fillStyle='red'; ctx.beginPath(); ctx.arc(this.x*scale,(this.y+bounce)*scale,this.size*scale,0,Math.PI*2); ctx.fill(); }}

// --- Egg ---
class Egg{ constructor(){ this.x=baseWidth/2 + (Math.random()*40-20); this.y=baseHeight/2 + (Math.random()*40-20); this.size=5; this.timer=0; this.hatchTime=600; } 
update(){ this.timer++; if(this.timer>=this.hatchTime){ 
let types=['worker','soldier','scout','harvester','medic','defender']; let type=types[Math.floor(Math.random()*types.length)]; 
let ant=new Ant(this.x,this.y,type); 
if(Math.random()<0.2){ ant.mutated=true; ant.color='#FFD700'; ant.speed*=1.2; ant.carryCapacity=(ant.carryCapacity||1)*2; } 
ants.push(ant); 
if(['worker','soldier','scout','harvester','medic','defender'].includes(ant.type)) playerControllableAnts.push(ant);
eggs.splice(eggs.indexOf(this),1); } } 
draw(){ let grow=Math.min(this.timer/this.hatchTime,1); ctx.fillStyle='orange'; ctx.beginPath(); ctx.arc(this.x*scale,this.y*scale,this.size*scale*grow,0,Math.PI*2); ctx.fill(); }}

// --- Ant ---
class Ant{ 
constructor(x,y,type='worker'){ 
this.x=x; this.y=y; this.type=type; this.size=type==='queen'?15:10; 
this.speed=(type==='soldier'?2:type==='scout'?3:type==='harvester'?1.8:type==='defender'?1:1.5); 
this.carryCapacity=(type==='harvester'?2:1); this.target=null; this.mutated=false; this.color=this.getColor(); this.health=3; this.maxHealth=3; this.carrying=false; 
if(type==='soldier'){ this.health=5; this.maxHealth=5;}
if(type==='defender'){ this.health=6; this.maxHealth=6;}
if(type==='medic'){ this.health=4; this.maxHealth=4;}
}
getColor(){ switch(this.type){case 'worker':return '#8B4513';case 'soldier':return '#1e90ff';case 'scout':return '#ffa500';case 'queen':return '#800080';case 'harvester':return '#228B22';case 'defender':return '#8B0000';case 'medic':return '#00FF7F';default:return '#333';}}
move(){ 
if(this.type==='queen') return; 
if(this.type==='worker'||this.type==='harvester'){ 
if(!this.target || this.target.collected) this.target=foods[Math.floor(Math.random()*foods.length)]||null; 
if(this.target){ this.goTo(this.target.x,this.target.y); if(this.getDistance(this.target)<5){ this.target.collected=true; colonyFood+=this.carryCapacity*5; score+=this.carryCapacity*5; this.target=null;}}
} 
if(this.type==='soldier'||this.type==='defender'){ let c=this.getClosestEnemy(); if(c){ this.goTo(c.x,c.y); if(this.getDistance(c)<this.size+c.size){ c.takeDamage(1); damages.push(new DamageText(c.x,c.y,1));}}} 
if(this.type==='scout'){ if(Math.random()<0.01) this.target={x:Math.random()*baseWidth,y:Math.random()*baseHeight}; if(this.target) this.goTo(this.target.x,this.target.y);}}
goTo(tx,ty){ let dx=tx-this.x,dy=ty-this.y,dist=Math.sqrt(dx*dx+dy*dy); if(dist>0){ this.x+=(dx/dist)*this.speed; this.y+=(dy/dist)*this.speed;}}
getDistance(obj){ return Math.sqrt((obj.x-this.x)**2+(obj.y-this.y)**2);}
getClosestEnemy(){ if(enemies.length===0) return null; let c=enemies[0],d=this.getDistance(c); for(let e of enemies){ let dist=this.getDistance(e); if(dist<d){ d=dist; c=e; }} return c;}
draw(){ 
ctx.fillStyle=this.color; ctx.beginPath(); ctx.arc(this.x*scale,this.y*scale,this.size*scale,0,Math.PI*2); ctx.fill(); ctx.strokeStyle='rgba(0,0,0,0.2)'; ctx.stroke();
// Health bar
const barWidth=this.size*2*scale; const barHeight=4; const healthRatio=this.health/this.maxHealth;
ctx.fillStyle='red'; ctx.fillRect((this.x-this.size)*scale,(this.y-this.size-6)*scale,barWidth*healthRatio,barHeight);
ctx.strokeStyle='black'; ctx.strokeRect((this.x-this.size)*scale,(this.y-this.size-6)*scale,barWidth,barHeight);
}
}

// --- Enemy ---
class Enemy{ constructor(x,y,type='spider'){ this.x=x; this.y=y; this.type=type; this.maxHealth=(type==='spider'?1:type==='beetle'?3:type==='wasp'?1:6); this.health=this.maxHealth; this.size=(type==='beetle'?15:type==='wasp'?10:12); this.speed=(type==='beetle'?0.8:type==='wasp'?3:1.2); this.damage=1; this.mutated=false; }
move(){ if(ants.length===0) return; let t=ants[Math.floor(Math.random()*ants.length)]; let dx=t.x-this.x, dy=t.y-this.y, dist=Math.sqrt(dx*dx+dy*dy); this.x+=(dx/dist)*this.speed; this.y+=(dy/dist)*this.speed; if(dist<this.size+t.size){ t.health-=this.damage; damages.push(new DamageText(t.x,t.y,this.damage)); if(t.health<=0) ants.splice(ants.indexOf(t),1);}}
draw(){ let bob=Math.sin(Date.now()/200)*2; ctx.fillStyle=this.mutated?'#800000':(this.type==='spider'?'darkred':this.type==='beetle'?'brown':'yellow'); ctx.beginPath(); ctx.arc(this.x*scale,(this.y+bob)*scale,this.size*scale,0,Math.PI*2); ctx.fill(); ctx.strokeStyle='black'; ctx.stroke(); ctx.fillStyle='red'; let barW=this.size*scale*2*(this.health/this.maxHealth); ctx.fillRect((this.x-this.size)*scale,(this.y-this.size-5)*scale,barW,4); ctx.strokeStyle='black'; ctx.strokeRect((this.x-this.size)*scale,(this.y-this.size-5)*scale,this.size*scale*2,4);}
takeDamage(a){ this.health-=a; damages.push(new DamageText(this.x,this.y,a)); if(this.health<=0) enemies.splice(enemies.indexOf(this),1);}
}

function spawnEnemy(type='spider'){ let e=new Enemy(Math.random()*baseWidth,Math.random()*baseHeight,type); if(Math.random()<0.15){ e.mutated=true; e.color='#800000'; e.maxHealth*=1.5; e.health=e.maxHealth; e.speed*=1.2;} enemies.push(e); }

function initGame(){ 
  ants=[]; enemies=[]; foods=[]; eggs=[]; damages=[]; colonyFood=0; score=0; gameTime=0;
  playerControllableAnts=[];
  playerAntIndex=0;
  ants.push(new Ant(baseWidth/2, baseHeight/2, 'queen')); 
  player = new Ant(baseWidth/2 + 50, baseHeight/2, 'worker');
  playerControllableAnts.push(player);
  for(let i=0;i<10;i++) foods.push(new Food(Math.random()*baseWidth, Math.random()*baseHeight));
  gameState='playing'; overlay.style.display='none';
}

document.addEventListener('keydown', e=>{
  if(gameState==='menu' && e.key==='Enter') initGame();
  if(gameState==='playing' && ['1','2','3','
